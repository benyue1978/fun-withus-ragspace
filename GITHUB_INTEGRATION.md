# RAGSpace GitHub é›†æˆåŠŸèƒ½

## æ¦‚è¿°

RAGSpaceç°åœ¨æ”¯æŒç›´æ¥ä»GitHubä»“åº“æŠ“å–å†…å®¹ï¼Œå°†RAGä»æ‰‹åŠ¨ä¸Šä¼ æ‰©å±•åˆ°è‡ªåŠ¨æŠ“å–ã€‚è¿™ä¸ªåŠŸèƒ½å…è®¸ç”¨æˆ·è¾“å…¥GitHubä»“åº“URLï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŠ“å–ä»“åº“ä¸­çš„æ–‡æ¡£å’Œä»£ç æ–‡ä»¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

### âœ… æ ¸å¿ƒåŠŸèƒ½
- **è‡ªåŠ¨æŠ“å–**: è¾“å…¥GitHubä»“åº“URLï¼Œè‡ªåŠ¨æŠ“å–æ‰€æœ‰ç›¸å…³æ–‡ä»¶
- **æ™ºèƒ½è¿‡æ»¤**: åªæŠ“å–æ–‡æ¡£å’Œä»£ç æ–‡ä»¶ï¼ˆ.md, .py, .js, .ts, .txtç­‰ï¼‰
- **å¤§å°é™åˆ¶**: è‡ªåŠ¨è·³è¿‡å¤§äº50KBçš„æ–‡ä»¶ï¼Œé¿å…embeddingå¤±è´¥
- **åˆ†æ”¯æ”¯æŒ**: æ”¯æŒæŒ‡å®šåˆ†æ”¯ï¼ˆé»˜è®¤ä¸ºmainï¼‰
- **ç»“æ„åŒ–å­˜å‚¨**: å°†ä»“åº“ä½œä¸ºçˆ¶æ–‡æ¡£ï¼Œæ–‡ä»¶ä½œä¸ºå­æ–‡æ¡£å­˜å‚¨

### âœ… æ”¯æŒçš„æ–‡ä»¶ç±»å‹
- **æ–‡æ¡£**: `.md`, `.txt`, `.rst`, `.adoc`
- **ä»£ç **: `.py`, `.js`, `.ts`, `.java`, `.cpp`, `.c`
- **é…ç½®**: `.json`, `.yaml`, `.yml`, `.toml`
- **å…¶ä»–**: `.sql`, `.sh`, `.bat`

## æŠ€æœ¯å®ç°

### 1. æ•°æ®ç»“æ„è®¾è®¡

é‡‡ç”¨çˆ¶å­æ–‡æ¡£ç»“æ„ï¼Œä¿æŒå‘åå…¼å®¹ï¼š

```json
{
  "type": "github",
  "name": "owner/repo",
  "url": "https://github.com/owner/repo",
  "content": "GitHub repository: owner/repo\n\nThis repository contains X files.",
  "metadata": {
    "repo": "owner/repo",
    "branch": "main",
    "file_count": 15,
    "owner": "owner",
    "repository": "repo"
  },
  "children": [
    {
      "type": "github_file",
      "name": "README.md",
      "url": "https://github.com/owner/repo/blob/main/README.md",
      "content": "# Project Title\n\nProject description...",
      "metadata": {
        "repo": "owner/repo",
        "branch": "main",
        "path": "README.md",
        "size": 1024,
        "sha": "abc123..."
      }
    }
  ]
}
```

### 2. GitHub API é›†æˆ

ä½¿ç”¨GitHubå®˜æ–¹APIï¼Œæ”¯æŒï¼š
- **åŒ¿åè®¿é—®**: æ— éœ€tokenå³å¯è®¿é—®publicä»“åº“
- **Tokenæ”¯æŒ**: ä½¿ç”¨tokenè·å¾—æ›´é«˜é€Ÿç‡é™åˆ¶
- **é€’å½’éå†**: è‡ªåŠ¨éå†ä»“åº“ç›®å½•ç»“æ„
- **å†…å®¹è§£ç **: è‡ªåŠ¨è§£ç base64ç¼–ç çš„æ–‡ä»¶å†…å®¹

### 3. é€Ÿç‡é™åˆ¶å¤„ç†

| è®¿é—®æ–¹å¼ | é€Ÿç‡é™åˆ¶ | å»ºè®®ç”¨é€” |
|----------|----------|----------|
| åŒ¿åè®¿é—® | 60æ¬¡/å°æ—¶/IP | å¼€å‘æµ‹è¯• |
| Tokenè®¿é—® | 5000æ¬¡/å°æ—¶/token | ç”Ÿäº§ç¯å¢ƒ |

## ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒé…ç½®

```bash
# åœ¨.envæ–‡ä»¶ä¸­æ·»åŠ GitHub tokenï¼ˆå¯é€‰ä½†æ¨èï¼‰
GITHUB_TOKEN=your-github-token
```

### 2. Webç•Œé¢ä½¿ç”¨

1. æ‰“å¼€RAGSpace Webç•Œé¢
2. è¿›å…¥"ğŸ“š Knowledge Management"æ ‡ç­¾
3. é€‰æ‹©ç›®æ ‡DocSet
4. ç‚¹å‡»"ğŸ™ Add GitHub Repo"æ ‡ç­¾
5. è¾“å…¥GitHubä»“åº“URLï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰ï¼š
   - `https://github.com/owner/repo`
   - `github.com/owner/repo`
   - `owner/repo`
6. å¯é€‰ï¼šæŒ‡å®šåˆ†æ”¯ï¼ˆé»˜è®¤ä¸ºmainï¼‰
7. ç‚¹å‡»"Add Repository"æŒ‰é’®

### 3. APIä½¿ç”¨

```python
from src.ragspace.storage import docset_manager

# æ·»åŠ GitHubä»“åº“åˆ°DocSet
result = docset_manager.add_github_repo_to_docset(
    repo_url="owner/repo",
    docset_name="My Docs",
    branch="main"
)
print(result)
```

### 4. MCPå·¥å…·ä½¿ç”¨

```bash
# é€šè¿‡MCPå·¥å…·æ·»åŠ GitHubä»“åº“
mcp-inspector --config mcp_inspector_config.json --server ragspace --cli --method tools/call --tool-name add_github_repo --params '{"repo_url": "owner/repo", "docset_name": "My Docs"}'
```

## æ”¯æŒçš„URLæ ¼å¼

GitHubæœåŠ¡æ”¯æŒå¤šç§URLæ ¼å¼ï¼š

### âœ… æ”¯æŒçš„æ ¼å¼
- `https://github.com/owner/repo`
- `github.com/owner/repo`
- `owner/repo`

### âŒ ä¸æ”¯æŒçš„æ ¼å¼
- `https://github.com/owner/repo/tree/main` (ä¼šè‡ªåŠ¨æå–ä¸ºowner/repo)
- `https://github.com/owner/repo/blob/main/file.md` (ä¼šæŠ“å–æ•´ä¸ªä»“åº“)

## æ•°æ®åº“è¿ç§»

### æ–°å¢å­—æ®µ

```sql
-- æ·»åŠ childrenå­—æ®µç”¨äºå­˜å‚¨å­æ–‡æ¡£
ALTER TABLE documents ADD COLUMN children jsonb DEFAULT '[]';

-- æ·»åŠ metadataå­—æ®µç”¨äºå­˜å‚¨å…ƒæ•°æ®
ALTER TABLE documents ADD COLUMN metadata jsonb DEFAULT '{}';

-- æ·»åŠ ç´¢å¼•ä»¥æé«˜æŸ¥è¯¢æ€§èƒ½
CREATE INDEX idx_documents_children ON documents USING GIN (children);
CREATE INDEX idx_documents_metadata ON documents USING GIN (metadata);

-- æ›´æ–°ç±»å‹çº¦æŸ
ALTER TABLE documents ADD CONSTRAINT documents_type_check 
  CHECK (type IN ('file', 'url', 'github', 'website', 'github_file', 'github_readme'));
```

### åº”ç”¨è¿ç§»

```bash
# åœ¨Supabaseæ§åˆ¶å°ä¸­è¿è¡Œè¿ç§»
supabase db push
```

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

| é”™è¯¯ç±»å‹ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|----------|------|----------|
| `Invalid GitHub URL` | URLæ ¼å¼ä¸æ­£ç¡® | æ£€æŸ¥URLæ ¼å¼ï¼Œç¡®ä¿ä¸ºowner/repoæ ¼å¼ |
| `Repository not found` | ä»“åº“ä¸å­˜åœ¨æˆ–ç§æœ‰ | ç¡®è®¤ä»“åº“å­˜åœ¨ä¸”ä¸ºpublic |
| `Rate limit exceeded` | è¶…è¿‡APIé€Ÿç‡é™åˆ¶ | æ·»åŠ GitHub tokenæˆ–ç­‰å¾…é‡ç½® |
| `File too large` | æ–‡ä»¶è¶…è¿‡50KBé™åˆ¶ | ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡å¤§æ–‡ä»¶ |
| `Branch not found` | åˆ†æ”¯ä¸å­˜åœ¨ | æ£€æŸ¥åˆ†æ”¯åç§°ï¼Œé»˜è®¤ä¸ºmain |

### è°ƒè¯•ä¿¡æ¯

ç³»ç»Ÿä¼šè¾“å‡ºè¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯ï¼š
- âœ… æˆåŠŸæŠ“å–çš„æ–‡ä»¶
- âš ï¸ è·³è¿‡çš„æ–‡ä»¶ï¼ˆå¤§å°è¶…é™ï¼‰
- âŒ å¤±è´¥çš„æ–‡ä»¶åŠåŸå› 
- ğŸ“Š é€Ÿç‡é™åˆ¶ä¿¡æ¯

## æ€§èƒ½ä¼˜åŒ–

### 1. æ–‡ä»¶è¿‡æ»¤ç­–ç•¥
- **ç±»å‹è¿‡æ»¤**: åªæŠ“å–æ–‡æ¡£å’Œä»£ç æ–‡ä»¶
- **å¤§å°é™åˆ¶**: è·³è¿‡å¤§äº50KBçš„æ–‡ä»¶
- **è·¯å¾„è¿‡æ»¤**: å¯é…ç½®å¿½ç•¥ç‰¹å®šè·¯å¾„ï¼ˆå¦‚node_modulesï¼‰

### 2. ç¼“å­˜ç­–ç•¥
- **å†…å®¹ç¼“å­˜**: é¿å…é‡å¤æŠ“å–ç›¸åŒæ–‡ä»¶
- **ç»“æ„ç¼“å­˜**: ç¼“å­˜ä»“åº“ç›®å½•ç»“æ„
- **å¢é‡æ›´æ–°**: æ”¯æŒå¢é‡æ›´æ–°å·²å­˜åœ¨çš„ä»“åº“

### 3. å¹¶å‘æ§åˆ¶
- **è¯·æ±‚é™æµ**: æ§åˆ¶APIè¯·æ±‚é¢‘ç‡
- **é”™è¯¯é‡è¯•**: è‡ªåŠ¨é‡è¯•å¤±è´¥çš„è¯·æ±‚
- **è¶…æ—¶å¤„ç†**: è®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´

## å®‰å…¨è€ƒè™‘

### 1. Tokenå®‰å…¨
- **ç¯å¢ƒå˜é‡**: Tokenå­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- **æœ€å°æƒé™**: åªè¯·æ±‚å¿…è¦çš„APIæƒé™
- **å®šæœŸè½®æ¢**: å»ºè®®å®šæœŸæ›´æ–°Token

### 2. å†…å®¹å®‰å…¨
- **å†…å®¹éªŒè¯**: éªŒè¯ä¸‹è½½çš„æ–‡ä»¶å†…å®¹
- **å¤§å°é™åˆ¶**: é˜²æ­¢æ¶æ„å¤§æ–‡ä»¶æ”»å‡»
- **ç±»å‹æ£€æŸ¥**: åªå¤„ç†å®‰å…¨çš„æ–‡ä»¶ç±»å‹

## æµ‹è¯•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
# æµ‹è¯•GitHubé›†æˆåŠŸèƒ½
python test_github_integration.py
```

### æµ‹è¯•ç”¨ä¾‹

1. **URLè§£ææµ‹è¯•**: éªŒè¯å„ç§URLæ ¼å¼çš„è§£æ
2. **APIè¿æ¥æµ‹è¯•**: æµ‹è¯•GitHub APIè¿æ¥
3. **ä»“åº“æŠ“å–æµ‹è¯•**: æµ‹è¯•å®Œæ•´ä»“åº“æŠ“å–æµç¨‹
4. **æ•°æ®åº“é›†æˆæµ‹è¯•**: æµ‹è¯•Supabaseå­˜å‚¨é›†æˆ

## æœªæ¥è®¡åˆ’

### 1. å³å°†å®ç°çš„åŠŸèƒ½
- **ç§æœ‰ä»“åº“æ”¯æŒ**: æ”¯æŒç§æœ‰ä»“åº“è®¿é—®
- **å¢é‡æ›´æ–°**: åªæ›´æ–°å˜æ›´çš„æ–‡ä»¶
- **Webhookæ”¯æŒ**: è‡ªåŠ¨åŒæ­¥ä»“åº“æ›´æ–°
- **å¤šåˆ†æ”¯æ”¯æŒ**: åŒæ—¶æŠ“å–å¤šä¸ªåˆ†æ”¯

### 2. æ€§èƒ½ä¼˜åŒ–
- **å¹¶è¡ŒæŠ“å–**: å¹¶å‘æŠ“å–å¤šä¸ªæ–‡ä»¶
- **æ™ºèƒ½ç¼“å­˜**: åŸºäºæ–‡ä»¶å“ˆå¸Œçš„æ™ºèƒ½ç¼“å­˜
- **å‹ç¼©å­˜å‚¨**: å‹ç¼©å­˜å‚¨å¤§æ–‡ä»¶å†…å®¹

### 3. ç”¨æˆ·ä½“éªŒ
- **è¿›åº¦æ˜¾ç¤º**: å®æ—¶æ˜¾ç¤ºæŠ“å–è¿›åº¦
- **é”™è¯¯æ¢å¤**: æ”¯æŒå¤±è´¥é‡è¯•
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ·»åŠ å¤šä¸ªä»“åº“

---

*æœ€åæ›´æ–°: 2024å¹´12æœˆ* 